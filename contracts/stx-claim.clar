;; SPDX-License-Identifier: BUSL-1.1
;; Data vars

(define-map user-rewards principal {
  earned-rewards: uint,
  claimed-rewards: bool,
})

;; CONSTANTS
(define-constant SUCCESS (ok true))

;; Errors
(define-constant ERR-NO-USER-REWARDS (err u130001))
(define-constant ERR-USER-REWARDS-CLAIMED (err u130002))

;; Read-only functions
(define-read-only (get-user-rewards (user principal))
  (ok (map-get? user-rewards user))
)

;; Public functions

(define-public (claim-rewards)
  (let (
      (user contract-caller)
      (rewards (unwrap! (map-get? user-rewards user) ERR-NO-USER-REWARDS))
      (reward-amount (get earned-rewards rewards))
    )
    (asserts! (not (get claimed-rewards rewards)) ERR-USER-REWARDS-CLAIMED)
    (if (> reward-amount u0) 
      (as-contract (try! (stx-transfer? reward-amount (as-contract contract-caller) user)))
      true
    )
    (map-set user-rewards user {
      earned-rewards: (get earned-rewards rewards),
      claimed-rewards: true,
    })
    (print {
      action: "claim-rewards",
      claimed-rewards: reward-amount,
      user: user
    })
    SUCCESS
))

(define-private (set-user-rewards (user principal) (rewards uint) )
  (begin 
    (map-set user-rewards user {
      earned-rewards: rewards,
      claimed-rewards: false,
    })
    (print {
      action: "user-rewards",
      new-rewards: rewards,
      user: user
    })
  )
)

(set-user-rewards 'SP1GJSC4GG3MDA1KYZJYS9FEVCKHASR1N7089BEQK u2000)
(set-user-rewards 'SP2FER95BTPCAPNQ5507ETSCDRP8ZNS4BJPJFA9V2 u6)
(set-user-rewards 'SP29XVH2WM204GCA37JXTXH0PZRAE3YRQMNK0NATG u753503)
(set-user-rewards 'SP1V1BS06A7PGHTRHMW9ZZMYVRAJGKNE7F215YVER u16)
(set-user-rewards 'SP2HR75CN7VBHPKF0YMV384NAE0NMERD1NGPM6M6K u1520921)
(set-user-rewards 'SP768Q0D4T86NFD4VPDCRFME6HJZ92HD05N4G08H u15059)
(set-user-rewards 'SP2T0W2S5FBWBJDMHAH64P606AJFGPV9NXN116V6W u249)
(set-user-rewards 'SP779SC9CDWQVMTRXT0HZCEHSDBXCHNGG7BC1H9B u1)
(set-user-rewards 'SPN3AV2KQ8HYFHGKC34SGVSS9TNMJXG56GXRSR70 u37617338)
(set-user-rewards 'SP3F2W2J9QPZPV3EWWEA09KWK61V6PTD006B911MG u32195272)
(set-user-rewards 'SP1ZCA2YV8TGX1NCJ8K04P5WJSGJVM1XD44APZD9Q u15895414)
(set-user-rewards 'SP1VN1E5GX5CC2CJZ5SJJ1A2WZM8VWA85B04904CE u15026)
(set-user-rewards 'SP1N6QYMS4771B58J5WDQMX917F2ZQJVD48RJH047 u136232803)
(set-user-rewards 'SP22DGADCDARESGJ1A9TJ1B8VMRW5BBSNGTW6P95N u52)
(set-user-rewards 'SP1Q0EYK475850ZGER56N1VM710CM3HNGNNBDW6Y2 u750456650)
(set-user-rewards 'SP2BHVMJTSDT2RBX9ZG3NSXC0DDCB6GVQX0HN2Z9K u1271161)
(set-user-rewards 'SPJ934BTQ7T1SB2AD81AVJZEKVFXS7G8C5VQXC10 u39494191)
(set-user-rewards 'SP2KW37HSHFBRSQXRT497XY55PEZAJZ9KBC7WVPT u323)
(set-user-rewards 'SPT9ZQHQT0ZSHSQN8PYNXGG1E7WV1N821ZMJQCBD u754198596)
(set-user-rewards 'SP3EB9GPTMSMYGW642TBRX51C40T8A73R48RPD9WK u4157079)
(set-user-rewards 'SP8VC8099JM2BVDBXY9PR71Z2CD8Z7WB7VYT4E9M u1296640)
(set-user-rewards 'SPFQXY917WD98YJ0EWBN9TTC2BWMV8DG72E0E8X7 u656042)
(set-user-rewards 'SP1H68DAV0HZZ2NJXD38DK12EXXSR7A39J5HT19N1 u11658073)
(set-user-rewards 'SPAP45V7W2HEY59D9QP6WZJ91RZRA4X64SK34R0G u28070317)
(set-user-rewards 'SP28M9DGNGEBAFX1G41DHDNYX0E6JSKR0CFDZ12SS u58940779)
(set-user-rewards 'SP2417H88DQFN7FNDMSKM9N0B3Q6GNGEM40W7ZAZW u30032)
(set-user-rewards 'SP2EX6YKM52T7GMCTJ8E2CTGMPVB4YBTJE5R0QZY5 u173447426)
(set-user-rewards 'SP1T07GK9H4M0WP4N1DSSA7NJ7GNTQZ0GBZM0GAR2 u8939774)
(set-user-rewards 'SPCF34WG1J12WASTD90Q49MRDC39M2QC6Y4AQ1B5 u689486387)
(set-user-rewards 'SP14TGZ8M5YVC0SM6NMF01D9JJ21T16A684NGSJ97 u99511)
(set-user-rewards 'SP2N0CKP37N6AXYE9G01N6TGA3CJ4SQKSP7QXCAV5 u52037162)
(set-user-rewards 'SPVCTW1FT0WTPRE73PHZRX0DXBB9YQ0W992Q6QZY u18009413)
(set-user-rewards 'SPR9P7SWQ410559B9S7RSNYYV90ZRZWJS9JTS11A u100655852)
(set-user-rewards 'SP3BVJWMM0XS72WY1G3SH72JCR34CNRG4FVW6KXP5 u62894731)
(set-user-rewards 'SP7EPGMZ6MZ37EYGGHEG4A23XCFYPWJ19WG70BHG u12327365)
(set-user-rewards 'SP6KVVWM5XQ040Q1WB33XB9Y9N2YZTNTJ4MTV8HX u327331924)
(set-user-rewards 'SP2TBW5EM2JEH10756JC1FSG784P0SVYZ9F2ZBJ7K u38708359)
(set-user-rewards 'SP96TKA644MJAAWK13YK3AGTG2MTHF0YBSWJ5GVH u4375259)
(set-user-rewards 'SP2QTMXY124DEBDV27G30QB5MC3SJV7FRJWV15D1X u32416458)
(set-user-rewards 'SP3TCNH1X2YSSC5KYE6B5N2PSN5T1BSPPBS235ZP9 u8491502)
(set-user-rewards 'SPK3EG816V3DC1RW8HVEQJ814XA3MFT8YC2AXGB5 u196640254)
(set-user-rewards 'SP3MZ2ZRQPZCMDAJS419VF8TPYBESD18N0SEG7GWC u16944604)
(set-user-rewards 'SP1D0DYDKRSF5CSJ7QNMJZEWKVEJWSJ9A8T0V891X u11037640)
(set-user-rewards 'SPMWCPXZJRDW3RP3NVQYAJHM71V2FMV9CMKR6GBR u1321343052)
(set-user-rewards 'SP15NVP0R8H16QD05FFWZDA63NAVW0C2K98JV8RND u5309938257)
(set-user-rewards 'SPTETYQFT9B9CK357K88PCF52TBZQ1WP9S3AR4S3 u18515)
(set-user-rewards 'SP399YK5JQ3Z7WWYBSV6NRB89MSKV07WE9BGZTQRY u16)
(set-user-rewards 'SP3178SS4Y1PH40020TEYEH0254ZZ4V3TDY2VBJ2E u91896)
(set-user-rewards 'SP11DP40CNXHQZZCGKZNP5ECX9MY6VV7YVH4DQP06 u172597)
(set-user-rewards 'SP3S5KFWY5H8BERS2ZA2X4T5NEV66FCTTG6VZP4ZD u601)
(set-user-rewards 'SP21GTVTEEDQBBQSK6FPEG4G4XGQRJGJDQV41CAD u12572)
(set-user-rewards 'SP3P8GFF3QH1ZQYHMAQ0777FT0Y89AWVDBH2K613A u93)
(set-user-rewards 'SP2VH5C759NFW2XJ5CNCG9H0BRP7X9FFD9S4MQ85B u1319620)
(set-user-rewards 'SPT82NHYPCR6F9FHZY27AWHPE6PM5TS639WK3A2Y u316829)
(set-user-rewards 'SP1KX23AAP40SC286N4JXWSD3VTV5BARGKMCK730M u165172)
(set-user-rewards 'SP39DC776TVRWSPSXNXCCM80APY6EBV4J1Y3HAZYJ u7555591)
(set-user-rewards 'SP1Q9GQX9H2ENC0YWPRR01W29MA4E824XSXR9ZVM2 u396410138)
(set-user-rewards 'SP3PY2KBZXE2PBD532Z16VERQMAP04QZ3TXYDZRZ8 u28)
(set-user-rewards 'SP1PTQGVNKDZBG7VTGZB136HH5G8WA9GVMHK8KX4X u6059217)
(set-user-rewards 'SP1DRZ91815ACV1BDX1V5EDP5NRREP038Q57TEABK u181)
(set-user-rewards 'SP3NNW6ERCEH72ZNMHAS79QEBTTNRMFSP40AV65B8 u153749)
(set-user-rewards 'SP3JKSRDHYTM633KGKJVBZ12DXF80G7VFQFQ61EQ9 u160366)
(set-user-rewards 'SP1FSX9QG8K0ZBFM104737ZN8KMB5S6PCM8J7TGMP u180187)
(set-user-rewards 'SP1WAQJTCW8EPNHGEDGSTS1W7G8SJHXXMEXTSTTP7 u185183)
(set-user-rewards 'SP2SXZ2KESG98XR05TB5EZC2BX0ZAGSXPSR35NQH0 u181027)
(set-user-rewards 'SP3VCX5NFQ8VCHFS9M6N40ZJNVTRT4HZ62WFH5C4Q u720742)
(set-user-rewards 'SP1AX2ND6NE41YNN9C0SDJV2N11X7684RBKQWB9XD u15127276)
(set-user-rewards 'SPRHE8QDRB5GFDRY79CJ6QZYD1HNMEG7965D1474 u152371)
(set-user-rewards 'SP2PP0V5HCG5BCHJN8ZTZ73QK60RW5QBPXRWH92H7 u151844)
(set-user-rewards 'SP2RB01JG4TM50XNX5N1DNBECB0X60VFPDXMD5PVP u170538)
(set-user-rewards 'SP10T7A039T36H5141YMEGF52DGSXT942K6MR90W4 u157298)
(set-user-rewards 'SP3FQ2HPJ63E6F9059DC382YFPY1B0Q3KQFPJF6SE u40)
(set-user-rewards 'SP2AFS93R0SNHCHHFCH9X9CJTPSHFD1PNM75F6AWD u33)
(set-user-rewards 'SP2CCCQP1WN3FG67K3V4S85JG9SRZN2KKRJ3M3GNG u533068917)
(set-user-rewards 'SP86QENQB6S45M2BMPE7Y1XJ76FQA4J5Z5WA5D9M u18225411)
(set-user-rewards 'SP2TJ5QDYQCTHJFDBKW2RPPT67FGJNR9RQE6ZW3JT u4496874)
(set-user-rewards 'SP11HP6JWVH61F64RR39B33TYPG82VATXTFX20YSJ u13837)
(set-user-rewards 'SP3V83T50GR4H1GDS9GZDCJYJMVGQRVDV1ZTQHA8W u1815126)
(set-user-rewards 'SP15MC6CP2VT4A7VZKBTD8C255A2D4JQ7CN5JVVJ3 u1645429551)
(set-user-rewards 'SP38A2GN20DT0A23SBE537G4H1D3VCYZCCM1C0MP5 u344986596)
(set-user-rewards 'SP2G0P8PWG999ZAQ4K9K8PDFHYY5F817RF515RNK8 u51936734)
(set-user-rewards 'SP262QWKYB8E3J0KM0PNX2B8KHBFETKQ7TEEGX0BY u185910741)
(set-user-rewards 'SP1BS7EF2KY09BPN7P4WME9EBFB7PEQCE44V6WDXG u31927993)
(set-user-rewards 'SPNN2PG9JQ84D14FJMXZE8JQJQ8S8Q1ZF7PNGW55 u799811165)
(set-user-rewards 'SP1J1AXM48HH1DJMCCEBBBEX5WQ92JHQXEP0WH4S8 u1501535)
(set-user-rewards 'SP15WYZ6SEFCFKTBXH3F3G0BGZZEZBKZKPCXVHE6R u78079172)
(set-user-rewards 'SP18QG8A8943KY9S15M08AMAWWF58W9X1M90BRCSJ u9377458)
(set-user-rewards 'SP3SWM3D2HSEDME25BEZ56T64N63NFMG5M49GM795 u51883)
(set-user-rewards 'SP3TFM448M3VC13Y5XBCZP3S5VWE7Z3823BVY9XQZ u34695254)
(set-user-rewards 'SP2B3AR9ZG3RNSVTRJ1YZ5X631YXHZVJSKZPXWQ5N u66145425)
(set-user-rewards 'SP22YFNH4BYXM6QK3XN55JTJSRBHE99K5VPH8S4BR u121694652)
(set-user-rewards 'SP257C3DMTE0QVV452JC0WC0J3JVF77367KMH8WDH u15827)
(set-user-rewards 'SP11F9RDXFPP8XCQ4V1QSE1E0CM3X2DQVEKB6WXT8 u16518)
(set-user-rewards 'SPJH144XQV4YAJJTD5FMWN97N46F6PVP6B4R1KPE u15316)
(set-user-rewards 'SP96TKA644MJAAWK13YK3AGTG2MTHF0YBSWJ5GVH u486140)
(set-user-rewards 'SP33TPVGG81W8RKD2M1CRQF2RRF528N3V6K7A6M7M u294355097)
(set-user-rewards 'SP1W5YQQ375XGC1Q14D8GZ22MJZMR6QYG9YAYSBC u1085761)
(set-user-rewards 'SPAFRYT831WS7ZRHGZBPMNCBJRBC0ZT884HFXERA u7703987)
(set-user-rewards 'SPE5HDPQGE360QSRTA7TQAVVX3DTV44530J1WH1X u1124084)
(set-user-rewards 'SP2G3E62BPK2GC2ME8R9BE1C8AEXCTP4X6E7JTJN0 u37646128)
(set-user-rewards 'SP2QPKZPPEBZ7ZB7E558TTW15X75S9VDHC09M9SJF u26276723)
(set-user-rewards 'SP12XVYY68X0HZQTJYJ3VD7FSHKFH8GGTPTRN77G7 u22528238)
(set-user-rewards 'SP3GPV7YEVS2VNFYYXEJA4HWXA0HFX4SMFK9F12P7 u249)
(set-user-rewards 'SP2ZQD9D4VGKJPCK2HD3YC78Q9J6PVK52HF1K1A9F u75078)
(set-user-rewards 'SP32FZJVSWMP4ZZ0A2WYRQRSVK42RN5X8ZE6BRE96 u30761548)
(set-user-rewards 'SP1GDVSCAR7VVHMY82HT2PDRNGDF9P0AZ4D1PMH6Z u6756846)
(set-user-rewards 'SP3HYEC2GY11HJJW1NY2ECDBDGBCYWZ7CSZ90G1YW u2252341439)
(set-user-rewards 'SP3SQN4HY8RA1715KJ526JBZ1DKPCNFFAQFYQKCTA u2251537130)
(set-user-rewards 'SPKS5WTT644FM8YD0R2C1KZ8N13N6JS51BBFE9Z4 u2265507548)
(set-user-rewards 'SP3Z48F269WCBK2486QFWDZN74EH6ZDGWAT5ZTYNK u2265906522)
(set-user-rewards 'SP1XVMT1ES9N3B40FSMX3FGN4W0W12YEEPKB29908 u1512372718)
(set-user-rewards 'SP1A2TSZKT4JFZJPYQK0QGWY0TKDTBFYHY1D9CF0M u10966986)
(set-user-rewards 'SPJVBHM3HAV9EN0CBR8711ZZ3H5J5HS6J7TP6SS2 u3828588)
(set-user-rewards 'SPN6PP6AWX1QXY86M6XT9PY6AF9SRM6RK9GXZ7F7 u30030300)
